81. WRITE A QUERY TO FIND SMITH'S MANAGER'S MANAGER HIREDATE.

SELECT HIREDATE 
FROM EMP
 WHERE EMPNO = ( SELECT MGR
 FROM EMP
 WHERE EMPNO = ( SELECT MGR
 FROM EMP
 WHERE ENAME = 'SMITH'));

82.LIST THE NUMBER OF EMPLOYEES WHOSE JOB IS SALESMAN WORKING FOR NEW YORK AND CHICAGO

SELECT COUNT(*) 
FROM EMP
 WHERE JOB = 'SALESMAN' AND LOC IN ('NEW YORK', 'CHICAGO');

83. LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800.

SELECT DNAME
  FROM DEPT
 WHERE DEPTNO IN ( SELECT DEPTNO
 FROM EMP
 WHERE HIREDATE BETWEEN '01-DEC-81' AND '31-DEC-82' AND SAL > 1800);
84.DISPLAY LOCATION OF THE EMPLOYEE WHO EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER

SELECT LOCATION
FROM EMP 
WHERE SAL = (SELECT MAX(SAL) 
FROM EMP
WHERE MANAGER IS NULL);

85. LIST EMPLOYEES WHO WORKS FOR ACCOUNTING DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT


SELECT *
 FROM EMP
 WHERE DNAME = 'ACCOUNTING' AND SAL > ( SELECT AVG(SAL) 
FROM EMP
 WHERE DNAME = 'ACCOUNTING' );

86. DISPLAY LOCATION OF THE EMPLOYEE WHO EARN COMMISSION

SELECT*
FROM DEPT
WHERE DEPTNO IN(SELECT DEPTNO
FROM EMP
WHERE COMM>0);


87.LIST THE EMPLOYEES WHO DOES NOT DIRECTLY REPORT TO PRESIDENT,HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL


SELECT*
FROM EMP
WHERE MGR NOT IN(SELECT EMPNO
FROM EMP WHERE JOB=’PRESIDENT’)AND
COMM>0 AND SAL>(SELECT MAX(SAL)
FROM EMP
WHERE JOB=’CLERK’));

88.DISPLAY ALL THE EMPLOYEES WHOSE SALARY IS GREATER THAN AVG SAL OF DEPARTMENT 20

SELECT *FROM EMP
WHERE SAL>(SELECT AVG(SAL)FROM  EMP
WHERE DEPTNO=20);

89. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK ,REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN SALARY
90.DISPLAY LOC AND DNAME WHOSE JOB IS MANAGER AND HAS SAL LESS THAN CLERK.

SELECT LOC ,DNAME
FROM DEPT
WHERE DEPTNO IN(
SELECT DEPTNO
 FROM EMP
WHERE JOB = 'MANAGER' AND SAL < ( SELECT MIN(SAL) 
FROM EMP 
WHERE JOB  = 'CLERK'));

